<!DOCTYPE html>
<html>

<head>
    <title>AuleWEB REST App</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="res/restest.css" />
    <link rel="stylesheet" href="res/style.css" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
</head>

<body>
    <h1>AuleWEB REST App</h1>
    <p>This is a template web application based on <strong>JakartaEE 10</strong> that runs on Apache <strong>Tomcat
            10.1</strong> with <strong>Java 14</strong> or above.</p>

    <p>The RESTful resources, grouped under the /rest prefix, are the following:</p>

    <h2> Get methods </h2>
    <p> Lista di metodi GET usati per recuperare informazioni. </p>
    <table class="restest" width="100%">
        <thead>
            <tr>
                <th>Path</th>
                <th>Method</th>
                <th>Parametri</th>
                <th>Significato</th>
                <th>Struttura URL (esempio)</th>
                <th>Prova tu</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td rowspan>/rest/aule/csv</td>
                <td>GET</td>
                <td></td>
                <td>Esportazione della lista delle aule in formato CSV</td>
                <td><a data-rest-test data-rest-test-target href="rest/aule/csv"><small>GET rest/aule/csv</small></a>
                </td>
                <td><button onclick="location.href='rest/aule/csv';" value="Download">Download</button>
                </td>
            </tr>
            <tr>
                <td rowspan="1">/rest/aule/{id}</td>
                <td>GET</td>
                <td>id: [1-9][0-9]*</td>
                <td>Informazioni relative all'Aula con id specificato</td>
                <td><a data-rest-test data-rest-test-target href="rest/aule/1"><small>GET rest/aule/1</small></a></td>
                <td> <a href="#get-aule-div" class="scroll-link">Clicca qui </td>
            </tr>
            <tr>
                <td rowspan="1">/rest/aule/{id}/attrezzature</td>
                <td>GET</td>
                <td>id: [1-9][0-9]*</td>
                <td>Lista delle attrezzature presenti nell'Aula con id specificato</td>
                <td><a data-rest-test data-rest-test-target href="rest/aule/1/attrezzature"><small>GET
                            rest/aule/1/attrezzature</small></a></td>
                <td> <a href="#get-attrezzature-div" class="scroll-link">Clicca qui</td>
            </tr>
            <tr>
                <td>/rest/eventi</td>
                <td>GET</td>
                <td>rangeStart: datetime, rangeEnd: datetime</td>
                <td>Lista degli eventi nel periodo specificato (compreso tra rangeStart e rangeEnd)</td>
                <td><a data-rest-test data-rest-test-target
                        href="rest/eventi?rangeStart=2024-01-06T00:00:00&amp;rangeEnd=2024-01-20T23:59:00"><small>GET
                            rest/eventi?rangeStart=2024-01-06T00:00:00&amp;rangeEnd=2024-01-20T23:59:00</small></a></td>
                <td><a href="#get-eventoForRange-div" class="scroll-link">Clicca qui </td>
            </tr>
            <tr>
                <td>/rest/eventi/{id}</td>
                <td>GET</td>
                <td>id: [1-9][0-9]*</td>
                <td>Informazioni relative all'Evento con id specificato</td>
                <td><a data-rest-test data-rest-test-target href="rest/eventi/1"><small>GET rest/eventi/1</small></a>
                </td>
                <td><a href="#get-evento-div" class="scroll-link">Clicca qui</td>
            </tr>
            <tr>
                <td rowspan="1">/rest/aule/{idAula}/eventi</td>
                <td>GET</td>
                <td>idAula: [1-9][0-9]*, rangeStart: dateTime</td>
                <td>!!Lista degli eventi nell'Aula con id specificato a partire dal range temporale specificato!!</td>
                <td><a data-rest-test data-rest-test-target
                        href="rest/aule/1/eventi?rangeStart=2024-06-13T00:00:00"><small>GET
                            /rest/aule/1/eventi?rangeStart=2024-06-13T00:00:00</small></a></td>
                <td class="output"></td>
            </tr>
            <tr>
                <td rowspan="1">/rest/eventi/attuali</td>
                <td>GET</td>
                <td></td>
                <td>Lista degli eventi attuali</td>
                <td><a data-rest-test data-rest-test-target href="rest/eventi/attuali"><small>GET
                            /rest/eventi/attuali</small></a></td>
                <td class="output"></td>
            </tr>
            <tr>
                <td rowspan="1">/rest/eventi/prossimi</td>
                <td>GET</td>
                <td>oreProssime: int</td>
                <td>Lista degli eventi prossimi a partire dal tempo specificato (dafault 3 ore)</td>
                <td><a data-rest-test data-rest-test-target href="rest/eventi/prossimi?oreProssime=48"><small>GET
                            /rest/eventi/prossimi?oreProssime=48</small></a></td>
                <td class="output"></td>
            </tr>
        </tbody>
    </table>

    <div class="get-info" id="get-aule-div">
        <label for="id_aula"> id aula: </label>
        <select style="width:30%" id="id_aula" name="lista_id_aule">
            <option selected>Scegli un'aula</option>
        </select>
        <input type="button" value="Informazioni Aula" onclick="getAula($('#get-aule-div #id_aula').val())" />
        <div id="data_container"></div>
    </div>
    <div class="get-info" id="get-attrezzature-div">
        <label for="id_aula"> id aula: </label>
        <select style="width:30%" id="id_aula" name="lista_id_aule">
            <option selected>Scegli un'aula</option>
        </select>
        <input type="button" value="Elenca attrezzature"
            onclick="getAttrezzatura($('#get-attrezzature-div #id_aula').val())" />
        <div id="data_container"></div>
    </div>
    <div class="get-info" id="get-eventoForRange-div">
        <label for="range_start"> Dal: </label>
        <input type="datetime-local" style="width:30%" id="range_start" required>
        <br>
        <label for="range_end"> Al: </label>
        <input type="datetime-local" style="width:30%" id="range_end" required>
        <br>
        <input type="button" value="Download Eventi"
            onclick="getEventiForRange($('#get-eventoForRange-div #range_start').val(), $('#get-eventoForRange-div #range_end').val())" />
        <div id="data_container"></div>
    </div>
    <div class="get-info" id="get-evento-div">
        <label for="id_aula"> id evento: </label>
        <select style="width:30%" id="id_evento" name="lista_id_eventi">
            <option selected>Scegli un evento</option>
        </select>
        <input type="button" value="Informazioni Evento" onclick="getEvento($('#get-evento-div #id_evento').val())" />
        <div id="data_container"></div>
    </div>


    <h2> Post methods </h2>
    <p> Metodi POST usati per inserire informazioni e creare nuove risorse.</p>
    <table class="restest" width="100%">
        <thead>
            <tr>
                <th>Path</th>
                <th>Method</th>
                <th>Parameters</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td rowspan="1">/rest/aule</td>
                <td>POST</td>
                <td>
                    <fieldset>
                        <legend>Crea nuova Aula</legend>
                        <form method="post" action="rest/aule" enctype="multipart/form-data">
                            <div>
                                <label for="nome_aula"> nome: </label> <input style="width:30%" type="text"
                                    value="C1.10" id="nome_aula" name="nome_aula" required /> <br>
                                <label for="luogo_aula"> luogo:</label>
                                <input style="width:30%" type="text" value="Coppito" id="luogo_aula" name="luogo_aula"
                                    required />
                                <br>
                                <label for="edificio_aula">edificio:</label>
                                <input style="width:30%" type="text" value="Coppito" id="edificio_aula"
                                    name="edificio_aula" required />
                                <br>
                                <label for="piano_aula"> piano:</label>
                                <input style="width:30%" type="text" value="1" id="piano_aula" name="piano_aula"
                                    required />
                                <br>
                                <label for="capienza_aula"> capienza</label>
                                <input style="width:30%" type="number" value="50" id="capienza_aula"
                                    name="capienza_aula" required />
                                <br>
                                <label for="email_responsabile_aula">email</label>
                                <input style="width:30%" type="text" value="u@u.u" id="email_responsabile_aula"
                                    name="email_responsabile_aula" required /> <br>
                                <label for="prese_elettriche_aula">prese elettriche: </label><input style="width:30%"
                                    type="number" value="1" id="prese_elettriche_aula" name="prese_elettriche-aula"
                                    required /> <br>
                                <label for="prese_rete_aula">prese rete:</label> <input style="width:30%" type="number"
                                    value="1" id="prese_rete_aula" name="prese_rete_aula" required /> <br>
                                <label for="note_aula">note:</label>
                                <input style="width:30%" type="text" value="C1.10" id="note_aula" name="note_aula"
                                    required /> <br>
                                <input type="button" value="addAula" onclick="addAula()" name="addAula_button"
                                    id="addAula_button" />
                            </div>
                        </form>
                    </fieldset>
                </td>
            </tr>
            <tr>
                <td rowspan="1">/rest/aule/<span id="assignGruppo-idAula">idAula</span>/gruppi</td>
                <td>POST</td>
                <td>
                    <fieldset>
                        <legend> Assegna un gruppo ad un aula</legend>
                        <form method="post" action="rest/aule/idAula/gruppi" enctype="multipart/form-data">
                            <div>
                                <label for="id_aula_gruppi"> id aula: </label>
                                <select style="width:30%" id="id_aula_gruppi" name="lista_id_aule" required>
                                </select>
                                <br>

                                <label for="id_gruppo_assign"> id gruppo:</label>
                                <select style="width:30%" id="id_gruppo_assign" name="id_gruppo" required>
                                </select>
                                <br>

                                <input type="button" value="assignGruppoAula"
                                    onclick="assignGruppoAula($('#id_aula_gruppi').val())"
                                    name="assignGruppoAula_button" id="assignGruppoAula_button" />
                            </div>
                        </form>
                    </fieldset>
                </td>
            </tr>

            <tr>
                <td rowspan="1">/rest/aule/csv</td>
                <td>POST</td>
                <td>
                    <fieldset>
                        <legend>Importa CSV Aule</legend>
                        <form method="post" action="rest/aule/csv" enctype="multipart/form-data">

                            <div>
                                <label for="fileCSV"> Seleziona file CSV per importare aule:</label><br>
                                <input type="file" id="fileCSV" accept=".csv" required>
                                <br>
                                <input type="button" value="importFileCSV" onclick="importAuleFromCSV()"
                                    name="importFileCSV_button" id="importFileCSV_button" />
                            </div>
                        </form>
                    </fieldset>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="restest" width="100%">
        <thead>
            <tr>
                <th>Path</th>
                <th>Method</th>
                <th>Parameters</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td rowspan="1">/rest/evento</td>
                <td>POST</td>
                <td>
                    <form method="post" action="rest/eventi">
                        <fieldset>
                            <legend>Crea nuovo evento</legend>
                            <div>
                                <label for="nome_evento"> nome: </label> <input style="width:30%" type="text"
                                    value="Evento XYZ" id="nome_evento" name="nome_evento" /> <br>
                                <label for="orario_inizio"> Data e orario di inizio:</label>
                                <input style="width:30%" type="datetime-local" value="2025-01-01T09:00"
                                    id="orario_inizio" name="orario_inizio">
                                <br>
                                <label for="orario_fine"> Data e orario di fine:</label>
                                <input style="width:30%" type="datetime-local" value="2025-01-01T11:00" id="orario_fine"
                                    name="orario_fine">
                                <br>
                                <label for="descrizione_evento"> descrizione:</label>
                                <input style="width:30%" type="text" value="Descrizione Evento XYZ"
                                    id="descrizione_evento" name="descrizione_evento">
                                <br>
                                <label for="nome_organizzatore_evento"> nome organizzatore:</label>
                                <input style="width:30%" type="text" value="Nome Organizzatore XYZ"
                                    id="nome_organizzatore_evento" name="nome_organizzatore_evento">
                                <br>
                                <label for="email_responsabile_evento"> email responsabile:</label>
                                <input style="width:30%" type="text" value="u@u.u" id="email_responsabile_evento"
                                    name="email_responsabile_evento">
                                <br>
                                <label for="tipologia_evento"> tipologia:</label>
                                <select style="width:40%" id="tipologia_evento" name="tipologia_evento">
                                    <option value="lezione">lezione</option>
                                    <option value="esame">esame</option>
                                    <option value="parziale">parziale</option>
                                    <option value="riunione">riunione</option>
                                    <option value="lauree">lauree</option>
                                    <option value="seminario">seminario</option>
                                    <option value="altro" selected>altro</option>
                                </select>
                                <br>
                                <label for="id_aula_evento"> id aula:</label>
                                <select style="width:30%" id="id_aula_evento" name="lista_id_aule">
                                </select>
                                <br>
                                <div id="corso_container">
                                    <label for="id_corso_evento"> id corso:</label>
                                    <select style="width:30%" id="id_corso_evento" name="lista_id_corso">
                                    </select>
                                </div>
                                <br>
                                <fieldset>
                                    <legend>Ricorrenza</legend>
                                    <input type="radio" id="ricorrenza_evento0" name="ricorrenza_evento" value="null"
                                        hidden checked />
                                    <input type="radio" id="ricorrenza_evento1" name="ricorrenza_evento"
                                        value="giornaliera" />
                                    <label for="ricorrenza_evento1">giornaliera</label>
                                    <input type="radio" id="ricorrenza_evento2" name="ricorrenza_evento"
                                        value="settimanale" />
                                    <label for="ricorrenza_evento2">settimanale</label>
                                    <input type="radio" id="ricorrenza_evento3" name="ricorrenza_evento"
                                        value="mensile" />
                                    <label for="ricorrenza_evento3">mensile</label>
                                    <input type="radio" id="ricorrenza_evento4" value="null" name="ricorrenza_evento"
                                        checked />
                                    <label for="ricorrenza_evento3">Non ricorrente</label>
                                    <br>
                                    <div id="ricorrenza_container" style="display: none;">
                                        <label for="data_fine_ricorrenza">Data di fine ricorrenza:</label>
                                        <input type="datetime-local" value="2025-01-01T11:00"
                                            id="data_fine_ricorrenza" />
                                    </div>
                                </fieldset>
                                <br>
                                <input type="button" value="Aggiungi Evento" id="addEvento_button" />
                                <input type="reset" value="Reset" id="reset_button" />
                            </div>
                        </fieldset>
                    </form>
                </td>
                <!-- <span data-rest-test-token data-rest-test-url="rest/aule" data-rest-test-method="post"
                                    data-rest-test-status="200" data-rest-test-content-type="application/json">rest/aule</span></td> -->
                <!--<td><a data-rest-test data-rest-test-target href="rest/aule"><small>POST rest/aule</small></a></td>-->
            </tr>

            <tr>
                <td rowspan="1">/rest/aule/<span id="modificaEvento-idEvento">idEvento</span></td>
                <td>PATCH</td>
                <td>
                    <form method="post" id="modifica_evento_form" action="rest/eventi">
                        <fieldset>
                            <legend>Modifica un Evento</legend>
                            <div>
                                <label for="id_evento_modifica"> id evento: </label>
                                <select style="width:30%" id="id_evento_modifica" name="lista_id_eventi" required>
                                    <option> --- </option>
                                </select>
                                <br>

                                <label for="nome_evento_modifica"> nome: </label>
                                <input style="width:30%" type="text" id="nome_evento_modifica"
                                    name="nome_evento_modifica" />
                                <br>

                                <label for="orario_inizio_modifica"> Data e orario di inizio:</label>
                                <input style="width:30%" type="datetime-local" id="orario_inizio_modifica"
                                    name="orario_inizio_modifica">
                                <br>

                                <label for="orario_fine_modifica"> Data e orario di fine:</label>
                                <input style="width:30%" type="datetime-local" id="orario_fine_modifica"
                                    name="orario_fine_modifica">
                                <br>

                                <label for="descrizione_evento_modifica"> descrizione:</label>
                                <input style="width:30%" type="text" id="descrizione_evento_modifica"
                                    name="descrizione_evento_modifica">
                                <br>

                                <label for="nome_organizzatore_evento_modifica"> nome organizzatore:</label>
                                <input style="width:30%" type="text" id="nome_organizzatore_evento_modifica"
                                    name="nome_organizzatore_evento_modifica">
                                <br>

                                <label for="email_responsabile_evento_modifica"> email responsabile:</label>
                                <input style="width:30%" type="text" id="email_responsabile_evento_modifica"
                                    name="email_responsabile_evento_modifica">
                                <br>

                                <label for="tipologia_evento_modifica"> tipologia:</label>
                                <select style="width:40%" id="tipologia_evento_modifica"
                                    name="tipologia_evento_modifica">
                                    <option value="altro" selected>altro</option>
                                    <option value="lezione">lezione</option>
                                    <option value="esame">esame</option>
                                    <option value="parziale">parziale</option>
                                    <option value="riunione">riunione</option>
                                    <option value="lauree">lauree</option>
                                    <option value="seminario">seminario</option>
                                </select>
                                <br>

                                <label for="id_aula_evento_modifica"> id aula:</label>
                                <select style="width:30%" id="id_aula_evento_modifica" name="lista_id_aule">
                                </select>
                                <br>

                                <div id="corso_container_modifica">
                                    <label for="id_corso_evento_modifica"> id corso:</label>
                                    <select style="width:30%" id="id_corso_evento_modifica" name="lista_id_corso">
                                    </select>
                                </div>
                                <br>

                                <input type="button" value="ModificaEvento" id="modificaEvento_button" />
                                <input type="reset" value="ResetModifica" id="reset_button_modifica" />
                            </div>
                        </fieldset>

                    </form>
                </td>
                <!-- <span data-rest-test-token data-rest-test-url="rest/aule" data-rest-test-method="post"
                                    data-rest-test-status="200" data-rest-test-content-type="application/json">rest/aule</span></td> -->
                <!--<td><a data-rest-test data-rest-test-target href="rest/aule"><small>POST rest/aule</small></a></td>-->
            </tr>

        </tbody>
    </table>
    <h2>Authentication</h2>
    <p>To test the login/logout resource <em>(AuthenticationRes)</em>, use the login form below. <strong>Links marked
            with &#x1f512; on this page call
            restful endpoints requiring a bearer token and can be clicked only after a successful login.</strong></p>

    <table class="restest" width="100%">
        <thead>
            <tr>
                <th>Path</th>
                <th>Method</th>
                <th>Parameters</th>
                <th>Payload</th>
                <th>Authentication</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><span data-rest-test-token data-rest-test-url="rest/auth/login" data-rest-test-method="post"
                        data-rest-test-status="200" data-rest-test-content-type="application/x-www-form-urlencoded"
                        data-rest-test-payload="username=u&password=p">/auth/login</span></td>
                <td>POST</td>
                <td></td>
                <td>form-encoded username and password</td>
                <td></td>
            </tr>
            <tr>
                <td><span data-rest-test-auth="1000" data-rest-test-url="rest/auth/logout"
                        data-rest-test-method="delete" data-rest-test-status="204">/auth/logout</span></td>
                <td>DELETE</td>
                <td></td>
                <td></td>
                <td>Bearer token</td>
            </tr>
            <tr>
                <td><span data-rest-test-auth data-rest-test-url="rest/auth/refresh" data-rest-test-method="get"
                        data-rest-test-status="200">/auth/refresh</span></td>
                <td>GET</td>
                <td></td>
                <td></td>
                <td>Bearer token</td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="5">
                    <form method="post" action="rest/auth/login" enctype="application/x-www-form-urlencoded">
                        <p>Username: <input style="width:30%" type="text" value="username1" id="username-field"
                                name="username-field" />
                            Password: <input style="width:30%" type="password" value="pass" id="password-field"
                                name="password-field" />
                            <input type="submit" value="login" name="login-button" id="login-button" />
                            <input type="submit" value="logout" name="logout-button" id="logout-button" />
                        </p>
                    </form>
                    <form method="post" action="rest/auth/login" enctype="application/x-www-form-urlencoded">
                        <p>Token: <input style="width:80%" type="text" id="token-field" name="token-field" /> <input
                                type="button" value="refresh" name="refresh-button" id="refresh-button" /></p>
                    </form>
                </td>
            </tr>
        </tfoot>
    </table>

    <div style="border: 1px solid gray; margin: 1em auto; padding: 1em">
        <p>
            <em>Note that this project includes a Javascript library that automatically checks the above endpoints when
                this webpage is opened. This library
                is not part of the JAX-RS framework and it is not required to implement RESTful resources, and has been
                developed only as an aid for the
                sample resources included in this project.</em>
        </p>
        <p>
            <span class="rest-test-message-error" style="color: red">
                Some tested endpoints did not return the expected result

            </span>
            <span class="rest-test-message-ok" style="color: green">
                All tested endpoints returned the correct result
            </span>
        </p>
    </div>


    <script src="res/utility.js">/* */</script>
    <script src="res/authentication.js">/* */</script>
    <script src="res/aule.js">/* */</script>
    <script src="res/eventi.js">/* */</script>
    <!-- <script src="res/restest.js">/* */</script> 
            <script>
                let tester = new Restest();
            </script>-->
</body>

</html>